var c=(d,o,t)=>new Promise((e,r)=>{var n=i=>{try{s(t.next(i))}catch(a){r(a)}},l=i=>{try{s(t.throw(i))}catch(a){r(a)}},s=i=>i.done?e(i.value):Promise.resolve(i.value).then(n,l);s((t=t.apply(d,o)).next())});import{W as h}from"./index-BsQCTjw0.js";class g extends h{constructor(){super(...arguments),this.hasInit=!1,this.initForWeb=o=>c(this,null,function*(){var t;try{yield this.loadSDK(),this.testSDK(),this.hasInit||((t=window.Kakao)===null||t===void 0||t.init(o),this.hasInit=!0)}catch(e){return console.error("Error loading Kakao SDK",e),Promise.reject(e)}}),this.goLogin=()=>(this.testSDK(),new Promise((o,t)=>{try{window.Kakao.Auth.login({throughTalk:!0,persistAccessToken:!0,success:e=>{console.log(e),this.response=e;const r=new Date;r.setSeconds(r.getSeconds()+e.expires_in);const n=new Date;n.setSeconds(n.getSeconds()+e.refresh_token_expires_in),o({accessToken:e.access_token,expiredAt:r.toISOString(),expiresIn:e.expires_in.toString(10),refreshToken:e.refresh_token,refreshTokenExpiresIn:e.refresh_token_expires_in.toString(10),tokenType:e.token_type,idToken:e.id_token,refreshTokenExpiredAt:e.refresh_token_expires_in.toString(10)})},fail:e=>{console.error("Kakao Login Failed",e),t(new Error("Kakao Login Failed"))}})}catch(e){console.error("Error during Kakao login",e),t(e)}})),this.loadSDK=()=>new Promise((o,t)=>{if(document.getElementById("kakao-script"))return o();const e=document.createElement("script");e.id="kakao-script",e.type="text/javascript",e.onload=o,e.onerror=t,e.src="//developers.kakao.com/sdk/js/kakao.min.js",document.head.appendChild(e)})}goLogout(){return c(this,null,function*(){return this.testSDK(),new Promise((o,t)=>{var e;const r=()=>{this.response=void 0,o()};try{(e=window.Kakao)===null||e===void 0||e.Auth.logout(r)}catch(n){console.error("Error logging out",n),t(n)}})})}getUserInfo(){return this.testSDK(),this.response?new Promise((o,t)=>{window.Kakao.API.request({url:"/v2/user/me",success:e=>{o({value:e})},fail:e=>{console.error(e),t(e)}})}):Promise.reject("Not logged in.")}sendLinkFeed(o){throw this.unimplemented("Not implemented on web.")}talkInChannel(o){throw this.unimplemented("Not implemented on web.")}testSDK(){if(!window.Kakao)throw new Error("Kakao script not loaded. Call initForWeb for first")}}export{g as KakaoLoginPluginWeb};
